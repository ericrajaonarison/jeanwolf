<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Radio Cube</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #000;
            font-family: Helvetica, Arial, sans-serif;
            touch-action: none;
            cursor: grab;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body.dragging {
            cursor: grabbing;
        }

        .radio-text {
            position: fixed;
            top: 40px;
            left: 40px;
            font-family: Helvetica, Arial, sans-serif;
            font-weight: 900;
            font-size: 80px;
            color: #fff;
            letter-spacing: -2px;
            line-height: 1;
            opacity: 0.95;
            z-index: 100;
            pointer-events: none;
            display: none;
        }

        .scene {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            perspective: 1200px;
            transform-style: preserve-3d;
            will-change: transform;
        }

        .cube {
            position: relative;
            width: 300px;
            height: 300px;
            transform-style: preserve-3d;
            transition: transform 0.05s linear;
            transform-origin: center center;
            pointer-events: none;
        }

        .cube-face {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 3px solid rgba(255, 0, 0, 0.3);
            background: rgba(255, 0, 0, 0.15);
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            pointer-events: none;
            box-sizing: border-box;
        }

        .player-wrapper {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 15px;
            pointer-events: auto;
            box-sizing: border-box;
        }

        .player-iframe {
            width: 100%;
            height: 100%;
            max-width: 300px;
            max-height: 450px;
            border: none;
            background: transparent;
            border-radius: 8px;
            pointer-events: auto;
        }

        /* Cube face positions */
        .cube-face-front  { transform: rotateY(0deg) translateZ(150px); }
        .cube-face-back   { transform: rotateY(180deg) translateZ(150px); }
        .cube-face-right  { transform: rotateY(90deg) translateZ(150px); }
        .cube-face-left   { transform: rotateY(-90deg) translateZ(150px); }
        .cube-face-top    { transform: rotateX(90deg) translateZ(150px); }
        .cube-face-bottom { transform: rotateX(-90deg) translateZ(150px); }

        /* Instructions */
        .instructions {
            position: fixed;
            bottom: 20px;
            left: 0;
            right: 0;
            text-align: center;
            color: white;
            font-size: 14px;
            opacity: 0;
            z-index: 100;
            pointer-events: none;
            transition: opacity 0.5s;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(5px);
        }

        .instructions.show {
            opacity: 0.7;
        }

        /* Desktop styles */
        @media (min-width: 769px) {
            .radio-text {
                display: block;
            }
            
            .cube {
                width: 400px;
                height: 400px;
            }
            
            .cube-face-front  { transform: rotateY(0deg) translateZ(200px); }
            .cube-face-back   { transform: rotateY(180deg) translateZ(200px); }
            .cube-face-right  { transform: rotateY(90deg) translateZ(200px); }
            .cube-face-left   { transform: rotateY(-90deg) translateZ(200px); }
            .cube-face-top    { transform: rotateX(90deg) translateZ(200px); }
            .cube-face-bottom { transform: rotateX(-90deg) translateZ(200px); }
            
            .player-iframe {
                max-width: 350px;
                max-height: 500px;
            }
        }

        /* Mobile styles */
        @media (max-width: 768px) {
            .scene {
                align-items: center;
                justify-content: center;
                padding-top: env(safe-area-inset-top);
            }
            
            .cube {
                width: 280px;
                height: 280px;
            }
            
            .cube-face-front  { transform: rotateY(0deg) translateZ(140px); }
            .cube-face-back   { transform: rotateY(180deg) translateZ(140px); }
            .cube-face-right  { transform: rotateY(90deg) translateZ(140px); }
            .cube-face-left   { transform: rotateY(-90deg) translateZ(140px); }
            .cube-face-top    { transform: rotateX(90deg) translateZ(140px); }
            .cube-face-bottom { transform: rotateX(-90deg) translateZ(140px); }
            
            .player-iframe {
                max-width: 260px;
                max-height: 400px;
            }
            
            .instructions {
                bottom: 60px;
                font-size: 12px;
            }
        }

        /* Very small phones */
        @media (max-width: 480px) and (orientation: portrait) {
            .cube {
                width: 250px;
                height: 250px;
            }
            
            .cube-face-front  { transform: rotateY(0deg) translateZ(125px); }
            .cube-face-back   { transform: rotateY(180deg) translateZ(125px); }
            .cube-face-right  { transform: rotateY(90deg) translateZ(125px); }
            .cube-face-left   { transform: rotateY(-90deg) translateZ(125px); }
            .cube-face-top    { transform: rotateX(90deg) translateZ(125px); }
            .cube-face-bottom { transform: rotateX(-90deg) translateZ(125px); }
            
            .player-iframe {
                max-width: 230px;
                max-height: 350px;
            }
        }

        /* Loading overlay */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 18px;
            z-index: 1000;
        }

        /* Hide scrollbars */
        ::-webkit-scrollbar {
            display: none;
        }
    </style>
</head>
<body>
    <div class="radio-text">RADIO</div>
    
    <div class="loading" id="loading">Loading Radio Cube...</div>
    
    <div class="scene" id="scene">
        <div class="cube" id="cube">
            <!-- Face 1 - Original Radio -->
            <div class="cube-face cube-face-front">
                <div class="player-wrapper">
                    <iframe 
                        allow="autoplay *; encrypted-media *;"
                        class="player-iframe"
                        sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-storage-access-by-user-activation allow-top-navigation-by-user-activation"
                        src="https://embed.music.apple.com/de/playlist/radio/pl.u-55D6ZNlH65KbDqe?l=en"
                    ></iframe>
                </div>
            </div>
            
            <!-- Face 2 - Radio 2 (first instance) -->
            <div class="cube-face cube-face-back">
                <div class="player-wrapper">
                    <iframe 
                        allow="autoplay *; encrypted-media *;"
                        class="player-iframe"
                        sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-storage-access-by-user-activation allow-top-navigation-by-user-activation"
                        src="https://embed.music.apple.com/de/playlist/radio-2/pl.u-pMylgxvSWJVDZ9j?l=en"
                    ></iframe>
                </div>
            </div>
            
            <!-- Face 3 - Radio 2 (second instance) -->
            <div class="cube-face cube-face-right">
                <div class="player-wrapper">
                    <iframe 
                        allow="autoplay *; encrypted-media *;"
                        class="player-iframe"
                        sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-storage-access-by-user-activation allow-top-navigation-by-user-activation"
                        src="https://embed.music.apple.com/de/playlist/radio-2/pl.u-pMylgxvSWJVDZ9j?l=en"
                    ></iframe>
                </div>
            </div>
            
            <!-- Face 4 - Radio 3 -->
            <div class="cube-face cube-face-left">
                <div class="player-wrapper">
                    <iframe 
                        allow="autoplay *; encrypted-media *;"
                        class="player-iframe"
                        sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-storage-access-by-user-activation allow-top-navigation-by-user-activation"
                        src="https://embed.music.apple.com/de/playlist/radio-3/pl.u-zPyLl9Rue01ypmo?l=en"
                    ></iframe>
                </div>
            </div>
            
            <!-- Face 5 - Radio 5 -->
            <div class="cube-face cube-face-top">
                <div class="player-wrapper">
                    <iframe 
                        allow="autoplay *; encrypted-media *;"
                        class="player-iframe"
                        sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-storage-access-by-user-activation allow-top-navigation-by-user-activation"
                        src="https://embed.music.apple.com/de/playlist/radio-5/pl.u-4JomaBmCJLE6Zg0?l=en"
                    ></iframe>
                </div>
            </div>
            
            <!-- Face 6 - Radio 6 -->
            <div class="cube-face cube-face-bottom">
                <div class="player-wrapper">
                    <iframe 
                        allow="autoplay *; encrypted-media *;"
                        class="player-iframe"
                        sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-storage-access-by-user-activation allow-top-navigation-by-user-activation"
                        src="https://embed.music.apple.com/de/playlist/radio-6/pl.u-55D6Zq7I65KbDqe?l=en"
                    ></iframe>
                </div>
            </div>
        </div>
    </div>
    
    <div class="instructions" id="instructions">
        Drag anywhere to rotate • Scroll to zoom • Click player to control music
    </div>

    <script>
        class RadioCube {
            constructor() {
                this.scene = document.getElementById('scene');
                this.cube = document.getElementById('cube');
                this.body = document.body;
                this.loading = document.getElementById('loading');
                this.instructions = document.getElementById('instructions');
                
                this.rotation = { x: 20, y: 20 };
                this.scale = 1;
                this.isDragging = false;
                this.startX = 0;
                this.startY = 0;
                this.lastX = 0;
                this.lastY = 0;
                this.velocity = { x: 0, y: 0 };
                this.lastTime = 0;
                this.autoRotate = true;
                this.hasInteracted = false;
                this.inertiaId = null;
                
                // Physical properties for heavier feel
                this.rotationSensitivity = 0.35;
                this.inertiaDecay = 0.85;
                this.minVelocity = 0.001;
                this.maxVelocity = 1.5;
                
                this.minScale = 0.5;
                this.maxScale = 2;
                
                this.init();
            }
            
            init() {
                // Initial rotation
                this.updateCubeTransform();
                
                // Setup event listeners - entire body is draggable
                this.setupEventListeners();
                
                // Start auto-rotation
                this.startAutoRotate();
                
                // Hide loading after short delay
                setTimeout(() => {
                    this.loading.style.opacity = '0';
                    setTimeout(() => {
                        this.loading.style.display = 'none';
                        // Show instructions briefly
                        this.instructions.classList.add('show');
                        setTimeout(() => {
                            this.instructions.classList.remove('show');
                        }, 3000);
                    }, 500);
                }, 1000);
            }
            
            setupEventListeners() {
                // Mouse events
                this.body.addEventListener('mousedown', this.handleMouseDown.bind(this));
                document.addEventListener('mousemove', this.handleMouseMove.bind(this));
                document.addEventListener('mouseup', this.handleMouseUp.bind(this));
                
                // Touch events with passive: false for better control
                this.body.addEventListener('touchstart', this.handleTouchStart.bind(this), { passive: false });
                document.addEventListener('touchmove', this.handleTouchMove.bind(this), { passive: false });
                document.addEventListener('touchend', this.handleTouchEnd.bind(this));
                
                // Wheel for zoom
                this.scene.addEventListener('wheel', this.handleWheel.bind(this), { passive: false });
                
                // Double click to reset
                this.body.addEventListener('dblclick', this.resetView.bind(this));
                
                // Double tap for mobile
                let lastTap = 0;
                this.body.addEventListener('touchstart', (e) => {
                    const currentTime = new Date().getTime();
                    if (currentTime - lastTap < 300) {
                        this.resetView();
                        e.preventDefault();
                    }
                    lastTap = currentTime;
                });
                
                // Handle window resize
                window.addEventListener('resize', this.handleResize.bind(this));
                
                // Clean up on page unload
                window.addEventListener('beforeunload', () => {
                    if (this.inertiaId) {
                        cancelAnimationFrame(this.inertiaId);
                    }
                });
            }
            
            handleMouseDown(e) {
                // Don't start drag on right click
                if (e.button !== 0) return;
                
                this.stopAutoRotate();
                this.isDragging = true;
                this.startX = e.clientX;
                this.startY = e.clientY;
                this.lastX = e.clientX;
                this.lastY = e.clientY;
                this.lastTime = Date.now();
                this.velocity = { x: 0, y: 0 };
                
                this.body.classList.add('dragging');
                
                // Clear any existing inertia
                if (this.inertiaId) {
                    cancelAnimationFrame(this.inertiaId);
                    this.inertiaId = null;
                }
            }
            
            handleMouseMove(e) {
                if (!this.isDragging) return;
                
                const currentTime = Date.now();
                const deltaTime = currentTime - this.lastTime;
                
                // Calculate movement
                const deltaX = e.clientX - this.lastX;
                const deltaY = e.clientY - this.lastY;
                
                // Update velocity (clamped for heavier feel)
                this.velocity.x = Math.max(-this.maxVelocity, Math.min(this.maxVelocity, deltaX / deltaTime));
                this.velocity.y = Math.max(-this.maxVelocity, Math.min(this.maxVelocity, deltaY / deltaTime));
                
                // Apply rotation with heavier feel
                this.rotation.y += deltaX * this.rotationSensitivity;
                this.rotation.x -= deltaY * this.rotationSensitivity;
                
                this.updateCubeTransform();
                
                this.lastX = e.clientX;
                this.lastY = e.clientY;
                this.lastTime = currentTime;
                this.hasInteracted = true;
            }
            
            handleMouseUp() {
                if (!this.isDragging) return;
                
                this.isDragging = false;
                this.body.classList.remove('dragging');
                
                // Apply inertia if there's enough velocity
                if (Math.abs(this.velocity.x) > this.minVelocity || 
                    Math.abs(this.velocity.y) > this.minVelocity) {
                    this.applyInertia();
                }
            }
            
            handleTouchStart(e) {
                if (e.touches.length !== 1) return;
                
                this.stopAutoRotate();
                this.isDragging = true;
                this.startX = e.touches[0].clientX;
                this.startY = e.touches[0].clientY;
                this.lastX = e.touches[0].clientX;
                this.lastY = e.touches[0].clientY;
                this.lastTime = Date.now();
                this.velocity = { x: 0, y: 0 };
                
                // Clear any existing inertia
                if (this.inertiaId) {
                    cancelAnimationFrame(this.inertiaId);
                    this.inertiaId = null;
                }
                
                e.preventDefault();
            }
            
            handleTouchMove(e) {
                if (!this.isDragging || e.touches.length !== 1) return;
                
                const currentTime = Date.now();
                const deltaTime = currentTime - this.lastTime;
                
                // Calculate movement
                const deltaX = e.touches[0].clientX - this.lastX;
                const deltaY = e.touches[0].clientY - this.lastY;
                
                // Update velocity (clamped for heavier feel)
                this.velocity.x = Math.max(-this.maxVelocity, Math.min(this.maxVelocity, deltaX / deltaTime));
                this.velocity.y = Math.max(-this.maxVelocity, Math.min(this.maxVelocity, deltaY / deltaTime));
                
                // Apply rotation (slightly more sensitive on mobile)
                this.rotation.y += deltaX * this.rotationSensitivity * 1.2;
                this.rotation.x -= deltaY * this.rotationSensitivity * 1.2;
                
                this.updateCubeTransform();
                
                this.lastX = e.touches[0].clientX;
                this.lastY = e.touches[0].clientY;
                this.lastTime = currentTime;
                this.hasInteracted = true;
                
                e.preventDefault();
            }
            
            handleTouchEnd(e) {
                if (!this.isDragging) return;
                
                this.isDragging = false;
                
                // Apply inertia if there's enough velocity
                if (Math.abs(this.velocity.x) > this.minVelocity || 
                    Math.abs(this.velocity.y) > this.minVelocity) {
                    this.applyInertia();
                }
            }
            
            handleWheel(e) {
                this.stopAutoRotate();
                
                const zoomIntensity = 0.001;
                const delta = e.deltaY * zoomIntensity;
                
                this.scale = Math.max(this.minScale, Math.min(this.maxScale, this.scale - delta));
                this.updateCubeTransform();
                
                e.preventDefault();
                this.hasInteracted = true;
            }
            
            handleResize() {
                // Keep cube centered
                this.updateCubeTransform();
            }
            
            applyInertia() {
                const animateInertia = () => {
                    // Stop if velocity is too low
                    if (Math.abs(this.velocity.x) < this.minVelocity && 
                        Math.abs(this.velocity.y) < this.minVelocity) {
                        this.velocity = { x: 0, y: 0 };
                        this.inertiaId = null;
                        return;
                    }
                    
                    // Apply velocity with frame time consideration
                    const frameTime = 16; // Approximate 60fps
                    this.rotation.y += this.velocity.x * frameTime * this.rotationSensitivity;
                    this.rotation.x -= this.velocity.y * frameTime * this.rotationSensitivity;
                    
                    // Decay velocity
                    this.velocity.x *= this.inertiaDecay;
                    this.velocity.y *= this.inertiaDecay;
                    
                    this.updateCubeTransform();
                    
                    this.inertiaId = requestAnimationFrame(animateInertia);
                };
                
                this.inertiaId = requestAnimationFrame(animateInertia);
            }
            
            updateCubeTransform() {
                // Normalize rotation
                this.rotation.x = this.rotation.x % 360;
                this.rotation.y = this.rotation.y % 360;
                
                // Use transform3d for GPU acceleration
                this.cube.style.transform = `
                    rotate3d(1, 0, 0, ${this.rotation.x}deg) 
                    rotate3d(0, 1, 0, ${this.rotation.y}deg) 
                    scale3d(${this.scale}, ${this.scale}, ${this.scale})
                `;
            }
            
            startAutoRotate() {
                if (this.autoRotate && !this.hasInteracted && !this.isDragging) {
                    this.rotation.y += 0.15;
                    this.updateCubeTransform();
                    requestAnimationFrame(() => this.startAutoRotate());
                }
            }
            
            stopAutoRotate() {
                this.autoRotate = false;
                this.hasInteracted = true;
            }
            
            resetView() {
                this.rotation = { x: 20, y: 20 };
                this.scale = 1;
                this.updateCubeTransform();
                this.stopAutoRotate();
                
                // Show instructions briefly
                this.instructions.classList.add('show');
                setTimeout(() => {
                    this.instructions.classList.remove('show');
                }, 2000);
            }
        }
        
        // Initialize when page is fully loaded
        window.addEventListener('load', () => {
            // Use setTimeout to ensure DOM is ready
            setTimeout(() => {
                window.radioCube = new RadioCube();
            }, 100);
        });
        
        // Handle visibility change to prevent auto-rotate when tab is hidden
        document.addEventListener('visibilitychange', () => {
            if (window.radioCube && document.hidden) {
                window.radioCube.autoRotate = false;
            }
        });
    </script>
</body>
</html>
